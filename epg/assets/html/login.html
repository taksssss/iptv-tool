<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>登录</title>
    <link rel="stylesheet" type="text/css" href="assets/css/login.css">
    <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon">
</head>
<body>
<script>
(function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        document.body.classList.add(savedTheme);
    } else {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add('dark');
        }
    }
})();
</script>
<div id="login-app" class="container">
    <h2>登录</h2>
    <form method="POST" @submit.prevent="submitLogin">
        <label for="password">管理密码：</label><br><br>
        <input type="password" id="password" name="password" v-model="password"><br><br>
        <input type="hidden" name="login" value="1">
        <input type="submit" value="登录">
    </form>
    <div class="button-container">
        <button type="button" @click="openChangePassword">更改密码</button>
    </div>
    <p v-if="errorMessage" style="color:red;" v-text="errorMessage"></p>
    <p v-if="successMessage" style="color:green;" v-html="successMessage"></p>
    <p v-if="changeErrorMessage" style="color:red;" v-text="changeErrorMessage"></p>
</div>

<!-- 底部显示 -->
<div class="footer">
    <a href="https://github.com/taksssss/iptv-tool" target="_blank" style="color: #888; text-decoration: none;">
        https://github.com/taksssss/iptv-tool
    </a>
</div>

<!-- 修改密码模态框 -->
<div id="changePasswordModal" class="modal" :style="{ display: showChangeModal ? 'block' : 'none' }">
    <div class="passwd-modal-content" @mousedown.stop>
        <span class="close" @click="closeChangePassword">&times;</span>
        <h2>更改登录密码</h2>
        <form method="POST" @submit.prevent="submitChangePassword">
            <div class="form-group">
                <label for="old_password">原密码</label>
                <input type="password" id="old_password" name="old_password" v-model="oldPassword">
            </div>
            <div class="form-group">
                <label for="new_password">新密码</label>
                <input type="password" id="new_password" name="new_password" v-model="newPassword">
            </div>
            <input type="hidden" name="change_password" value="1">
            <input type="submit" value="更改密码" style="margin-top: 15px;">
        </form>
    </div>
</div>
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<script src="assets/js/login-vue.js"></script>
</body>
</html>